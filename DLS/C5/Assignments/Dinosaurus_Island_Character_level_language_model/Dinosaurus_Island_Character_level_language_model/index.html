
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This is a collection of all the notebooks from various courses I have taken.">
      
      
        <meta name="author" content="Harikesh Kushwaha">
      
      
        <link rel="canonical" href="https://hari31416.github.io/Courses/DLS/C5/Assignments/Dinosaurus_Island_Character_level_language_model/Dinosaurus_Island_Character_level_language_model/">
      
      
        <link rel="prev" href="../../Building_a_Recurrent_Neural_Network_Step_by_Step/Building_a_Recurrent_Neural_Network_Step_by_Step/">
      
      
        <link rel="next" href="../../Emojify/Emoji_v3a/">
      
      <link rel="icon" href="../../../../../assets/ml.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Dinosaurus Island Character level language model - Courses</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#character-level-language-model-dinosaurus-island" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Courses" class="md-header__button md-logo" aria-label="Courses" data-md-component="logo">
      
  <img src="../../../../../assets/ml.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Courses
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dinosaurus Island Character level language model
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Hari31416/Courses" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Courses
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Courses" class="md-nav__button md-logo" aria-label="Courses" data-md-component="logo">
      
  <img src="../../../../../assets/ml.png" alt="logo">

    </a>
    Courses
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Hari31416/Courses" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Courses
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Deep Learning Specialization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Deep Learning Specialization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          C1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          C1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C1/Assignments/Building_your_Deep_Neural_Network_Step_by_Step/Building_your_Deep_Neural_Network_Step_by_Step/" class="md-nav__link">
        Building your Deep Neural Network Step by Step
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C1/Assignments/Deep_Neural_Network_-_Application/Deep_Neural_Network_-_Application/" class="md-nav__link">
        Deep Neural Network   Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C1/Assignments/Logistic_Regression_with_a_Neural_Network_mindset/Logistic_Regression_with_a_Neural_Network_mindset/" class="md-nav__link">
        Logistic Regression with a Neural Network mindset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C1/Assignments/Planar_data_classification_with_one_hidden_layer/Planar_data_classification_with_one_hidden_layer/" class="md-nav__link">
        Planar data classification with one hidden layer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          C2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          C2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C2/Assignments/Gradient_Checking/Gradient_Checking/" class="md-nav__link">
        Gradient Checking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C2/Assignments/Initialization/Initialization/" class="md-nav__link">
        Initialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C2/Assignments/Optimization_Methods/Optimization_methods/" class="md-nav__link">
        Optimization methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C2/Assignments/Regularization/Regularization/" class="md-nav__link">
        Regularization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C2/Assignments/Tensorflow_introduction/Tensorflow_introduction/" class="md-nav__link">
        Tensorflow introduction
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          C4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          C4
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C4/Assignments/Car_detection_with_YOLO/Autonomous_driving_application_Car_detection/" class="md-nav__link">
        Autonomous driving application Car detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C4/Assignments/Convolution_model_Application/Convolution_model_Application/" class="md-nav__link">
        Convolution model Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C4/Assignments/Image_segmentation_Unet/Image_segmentation_Unet_v2/" class="md-nav__link">
        Image segmentation Unet v2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C4/Assignments/Residual_Networks/Residual_Networks/" class="md-nav__link">
        Residual Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../C4/Assignments/Transfer_learning_with_MobileNet/Transfer_learning_with_MobileNet_v1/" class="md-nav__link">
        Transfer learning with MobileNet v1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          C5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          C5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Building_a_Recurrent_Neural_Network_Step_by_Step/Building_a_Recurrent_Neural_Network_Step_by_Step/" class="md-nav__link">
        Building a Recurrent Neural Network Step by Step
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Dinosaurus Island Character level language model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Dinosaurus Island Character level language model
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-note-on-submission-to-the-autograder" class="md-nav__link">
    Important Note on Submission to the AutoGrader
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packages" class="md-nav__link">
    Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-problem-statement" class="md-nav__link">
    1 - Problem Statement
  </a>
  
    <nav class="md-nav" aria-label="1 - Problem Statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-dataset-and-preprocessing" class="md-nav__link">
    1.1 - Dataset and Preprocessing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-overview-of-the-model" class="md-nav__link">
    1.2 - Overview of the Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-building-blocks-of-the-model" class="md-nav__link">
    2 - Building Blocks of the Model
  </a>
  
    <nav class="md-nav" aria-label="2 - Building Blocks of the Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-clipping-the-gradients-in-the-optimization-loop" class="md-nav__link">
    2.1 - Clipping the Gradients in the Optimization Loop
  </a>
  
    <nav class="md-nav" aria-label="2.1 - Clipping the Gradients in the Optimization Loop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploding-gradients" class="md-nav__link">
    Exploding gradients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gradient-clipping" class="md-nav__link">
    Gradient clipping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-1-clip" class="md-nav__link">
    Exercise 1 - clip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-sampling" class="md-nav__link">
    2.2 - Sampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-sample" class="md-nav__link">
    Exercise 2 - sample
  </a>
  
    <nav class="md-nav" aria-label="Exercise 2 - sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-hints" class="md-nav__link">
    Additional Hints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-hints_1" class="md-nav__link">
    Additional Hints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-building-the-language-model" class="md-nav__link">
    3 - Building the Language Model
  </a>
  
    <nav class="md-nav" aria-label="3 - Building the Language Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-gradient-descent" class="md-nav__link">
    3.1 - Gradient Descent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-optimize" class="md-nav__link">
    Exercise 3 - optimize
  </a>
  
    <nav class="md-nav" aria-label="Exercise 3 - optimize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-training-the-model" class="md-nav__link">
    3.2 - Training the Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-model" class="md-nav__link">
    Exercise 4 - model
  </a>
  
    <nav class="md-nav" aria-label="Exercise 4 - model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-the-index-idx-into-the-list-of-examples" class="md-nav__link">
    Set the index idx into the list of examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-a-single-example-from-the-list-of-examples" class="md-nav__link">
    Extract a single example from the list of examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-a-string-into-a-list-of-characters-single_example_chars" class="md-nav__link">
    Convert a string into a list of characters: single_example_chars
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-list-of-characters-to-a-list-of-integers-single_example_ix" class="md-nav__link">
    Convert list of characters to a list of integers: single_example_ix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-list-of-input-characters-x" class="md-nav__link">
    Create the list of input characters: X
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-integer-representation-of-the-newline-character-ix_newline" class="md-nav__link">
    Get the integer representation of the newline character ix_newline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-the-list-of-labels-integer-representation-of-the-characters-y" class="md-nav__link">
    Set the list of labels (integer representation of the characters): Y
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#congratulations" class="md-nav__link">
    Congratulations!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-writing-like-shakespeare-optionalungraded" class="md-nav__link">
    4 - Writing like Shakespeare (OPTIONAL/UNGRADED)
  </a>
  
    <nav class="md-nav" aria-label="4 - Writing like Shakespeare (OPTIONAL/UNGRADED)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#congratulations-on-finishing-this-notebook" class="md-nav__link">
    Congratulations on finishing this notebook!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-references" class="md-nav__link">
    5 - References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Emojify/Emoji_v3a/" class="md-nav__link">
        Emoji v3a
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Improvise_a_Jazz_Solo_with_an_LSTM_Network/Improvise_a_Jazz_Solo_with_an_LSTM_Network_v4/" class="md-nav__link">
        Improvise a Jazz Solo with an LSTM Network v4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Neural_machine_translation_with_attention/Neural_machine_translation_with_attention_v4a/" class="md-nav__link">
        Neural machine translation with attention v4a
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Operations_on_Word_Vectors_Debiasing/Operations_on_word_vectors_v2a/" class="md-nav__link">
        Operations on word vectors v2a
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Machine Learning Specialization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Machine Learning Specialization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          C1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          C1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/C1_W1_Lab03_Model_Representation_Soln/" class="md-nav__link">
        C1 W1 Lab03 Model Representation Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/C1_W1_Lab04_Cost_function_Soln/" class="md-nav__link">
        C1 W1 Lab04 Cost function Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/C1_W1_Lab05_Gradient_Descent_Soln/" class="md-nav__link">
        C1 W1 Lab05 Gradient Descent Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/betaversion/C1_W1_Lab01_Python_Jupyter_Soln/" class="md-nav__link">
        C1 W1 Lab01 Python Jupyter Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/betaversion/C1_W1_Lab02_Course_Preview_Soln/" class="md-nav__link">
        C1 W1 Lab02 Course Preview Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/betaversion/C1_W1_Lab03_Model_Representation_Soln/" class="md-nav__link">
        C1 W1 Lab03 Model Representation Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/betaversion/C1_W1_Lab04_Cost_function_Soln/" class="md-nav__link">
        C1 W1 Lab04 Cost function Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Assignments/Gradient_Descent/betaversion/C1_W1_Lab05_Gradient_Descent_Soln/" class="md-nav__link">
        C1 W1 Lab05 Gradient Descent Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Notes/Linear_Regression/" class="md-nav__link">
        Linear Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W1/Notes/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/C1_W2_Lab01_Python_Numpy_Vectorization_Soln/" class="md-nav__link">
        C1 W2 Lab01 Python Numpy Vectorization Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/C1_W2_Lab02_Multiple_Variable_Soln/" class="md-nav__link">
        C1 W2 Lab02 Multiple Variable Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/C1_W2_Lab03_Feature_Scaling_and_Learning_Rate_Soln/" class="md-nav__link">
        C1 W2 Lab03 Feature Scaling and Learning Rate Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/C1_W2_Lab04_FeatEng_PolyReg_Soln/" class="md-nav__link">
        C1 W2 Lab04 FeatEng PolyReg Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/C1_W2_Lab05_Sklearn_GD_Soln/" class="md-nav__link">
        C1 W2 Lab05 Sklearn GD Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/C1_W2_Lab06_Sklearn_Normal_Soln/" class="md-nav__link">
        C1 W2 Lab06 Sklearn Normal Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W2/Assignments/Linear_Regression/C1_W2_Linear_Regression/" class="md-nav__link">
        C1 W2 Linear Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab01_Classification_Soln/" class="md-nav__link">
        C1 W3 Lab01 Classification Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab02_Sigmoid_function_Soln/" class="md-nav__link">
        C1 W3 Lab02 Sigmoid function Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab03_Decision_Boundary_Soln/" class="md-nav__link">
        C1 W3 Lab03 Decision Boundary Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab04_LogisticLoss_Soln/" class="md-nav__link">
        C1 W3 Lab04 LogisticLoss Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab05_Cost_Function_Soln/" class="md-nav__link">
        C1 W3 Lab05 Cost Function Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab07_Scikit_Learn_Soln/" class="md-nav__link">
        C1 W3 Lab07 Scikit Learn Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab08_Overfitting_Soln/" class="md-nav__link">
        C1 W3 Lab08 Overfitting Soln
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C1/W3/Assignments/C1_W3_Lab09_Regularization_Soln/" class="md-nav__link">
        C1 W3 Lab09 Regularization Soln
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          C2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          C2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W1/Assignment/C2_W1_Assignment/" class="md-nav__link">
        C2 W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W1/Lab/C2_W1_Lab01_Neurons_and_Layers/" class="md-nav__link">
        C2 W1 Lab01 Neurons and Layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W1/Lab/C2_W1_Lab02_CoffeeRoasting_TF/" class="md-nav__link">
        C2 W1 Lab02 CoffeeRoasting TF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W1/Lab/C2_W1_Lab03_CoffeeRoasting_Numpy/" class="md-nav__link">
        C2 W1 Lab03 CoffeeRoasting Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W2/Assignment/C2_W2_Assignment/" class="md-nav__link">
        C2 W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W2/Lab/C2_W2_Multiclass_TF/" class="md-nav__link">
        C2 W2 Multiclass TF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W2/Lab/C2_W2_Relu/" class="md-nav__link">
        C2 W2 Relu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W2/Lab/C2_W2_SoftMax/" class="md-nav__link">
        C2 W2 SoftMax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W3/Assignment/C2_W3_Assignment/" class="md-nav__link">
        C2 W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C2/W4/Assignment/C2_W4_Decision_Tree_with_Markdown/" class="md-nav__link">
        C2 W4 Decision Tree with Markdown
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          C3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          C3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C3/W1/Assignment/A1/C3_W1_KMeans_Assignment/" class="md-nav__link">
        C3 W1 KMeans Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C3/W1/Assignment/A2/C3_W1_Anomaly_Detection/" class="md-nav__link">
        C3 W1 Anomaly Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C3/W2/Assignment/A1/C3_W2_Collaborative_RecSys_Assignment/" class="md-nav__link">
        C3 W2 Collaborative RecSys Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C3/W2/Assignment/A2/C3_W2_RecSysNN_Assignment/" class="md-nav__link">
        C3 W2 RecSysNN Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C3/W3/Assignment/C3_W3_A1_Assignment/" class="md-nav__link">
        C3 W3 A1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MLS/C3/W3/Lab/State-action%20value%20function%20example/" class="md-nav__link">
        State action value function example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          TensorFlow Advanced Techniques Specialization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          TensorFlow Advanced Techniques Specialization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          C1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          C1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W1/Labs/C1_W1_Lab_1_functional-practice/" class="md-nav__link">
        C1 W1 Lab 1 functional practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W1/Labs/C1_W1_Lab_2_multi-output/" class="md-nav__link">
        C1 W1 Lab 2 multi output
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W1/Labs/C1_W1_Lab_3_siamese-network/" class="md-nav__link">
        C1 W1 Lab 3 siamese network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W1/Multiple_Output_Models_using_the_Keras_Functional_API/C1W1_Assignment/" class="md-nav__link">
        C1W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W2/Creating_a_Custom_Loss_Function/C1W2_Assignment/" class="md-nav__link">
        C1W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W2/Labs/C1_W2_Lab_1_huber-loss/" class="md-nav__link">
        C1 W2 Lab 1 huber loss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W2/Labs/C1_W2_Lab_2_huber-object-loss/" class="md-nav__link">
        C1 W2 Lab 2 huber object loss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W3/Implement_a_Quadratic_Layer/C1W3_Assignment/" class="md-nav__link">
        C1W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W3/Labs/C1_W3_Lab_1_lambda-layer/" class="md-nav__link">
        C1 W3 Lab 1 lambda layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W3/Labs/C1_W3_Lab_2_custom-dense-layer/" class="md-nav__link">
        C1 W3 Lab 2 custom dense layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W3/Labs/C1_W3_Lab_3_custom-layer-activation/" class="md-nav__link">
        C1 W3 Lab 3 custom layer activation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W4/Create_a_VGG_network/C1W4_Assignment/" class="md-nav__link">
        C1W4 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W4/Labs/C1_W4_Lab_1_basic-model/" class="md-nav__link">
        C1 W4 Lab 1 basic model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C1/W4/Labs/C1_W4_Lab_2_resnet-example/" class="md-nav__link">
        C1 W4 Lab 2 resnet example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          C2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          C2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W1/Assignment/C2W1_Assignment/" class="md-nav__link">
        C2W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W1/Labs/C2_W1_Lab_1_basic-tensors/" class="md-nav__link">
        C2 W1 Lab 1 basic tensors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W1/Labs/C2_W1_Lab_2_gradient-tape-basics/" class="md-nav__link">
        C2 W1 Lab 2 gradient tape basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W2/Assignment/C2W2_Assignment/" class="md-nav__link">
        C2W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W2/Labs/C2_W2_Lab_1_training-basics/" class="md-nav__link">
        C2 W2 Lab 1 training basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W2/Labs/C2_W2_Lab_2_training-categorical/" class="md-nav__link">
        C2 W2 Lab 2 training categorical
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W3/Assignment/C2W3_Assignment/" class="md-nav__link">
        C2W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W3/Labs/C2_W3_Lab_1_autograph-basics/" class="md-nav__link">
        C2 W3 Lab 1 autograph basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W3/Labs/C2_W3_Lab_2-graphs-for-complex-code/" class="md-nav__link">
        C2 W3 Lab 2 graphs for complex code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W4/Assignment/C2W4_Assignment/" class="md-nav__link">
        C2W4 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W4/Labs/C2_W4_Lab_1_basic-mirrored-strategy/" class="md-nav__link">
        C2 W4 Lab 1 basic mirrored strategy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W4/Labs/C2_W4_Lab_2_multi-GPU-mirrored-strategy/" class="md-nav__link">
        C2 W4 Lab 2 multi GPU mirrored strategy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W4/Labs/C2_W4_Lab_3_using-TPU-strategy/" class="md-nav__link">
        C2 W4 Lab 3 using TPU strategy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C2/W4/Labs/C2_W4_Lab_4_one-device-strategy/" class="md-nav__link">
        C2 W4 Lab 4 one device strategy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          C3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          C3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W1/Assignment/C3W1_Assignment/" class="md-nav__link">
        C3W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W1/Labs/C3_W1_Lab_2_Transfer_Learning_CIFAR_10/" class="md-nav__link">
        C3 W1 Lab 2 Transfer Learning CIFAR 10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W1/Labs/C3_W1_Lab_3_Object_Localization/" class="md-nav__link">
        C3 W1 Lab 3 Object Localization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W2/Assignment/C3W2_Assignment/" class="md-nav__link">
        C3W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W2/Labs/C3_W2_Lab_1_Simple_Object_Detection/" class="md-nav__link">
        C3 W2 Lab 1 Simple Object Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W2/Labs/Object_Detection_Inference_on_TF_2_and_TF_Hub/" class="md-nav__link">
        Object Detection Inference on TF 2 and TF Hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W3/Assignment/C3W3_Assignment/" class="md-nav__link">
        C3W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W3/Labs/C3_W3_Lab_1_VGG16_FCN8_CamVid/" class="md-nav__link">
        C3 W3 Lab 1 VGG16 FCN8 CamVid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W3/Labs/C3_W3_Lab_2_OxfordPets_UNet/" class="md-nav__link">
        C3 W3 Lab 2 OxfordPets UNet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W3/Labs/C3_W3_Lab_3_Mask_RCNN_ImageSegmentation/" class="md-nav__link">
        C3 W3 Lab 3 Mask RCNN ImageSegmentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W4/Assignment/C3_W4_Assignment/" class="md-nav__link">
        C3 W4 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W4/Labs/C3_W4_Lab_1_FashionMNIST_CAM/" class="md-nav__link">
        C3 W4 Lab 1 FashionMNIST CAM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W4/Labs/C3_W4_Lab_2_CatsDogs_CAM/" class="md-nav__link">
        C3 W4 Lab 2 CatsDogs CAM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C3/W4/Labs/C3_W4_Lab_3_Saliency/" class="md-nav__link">
        C3 W4 Lab 3 Saliency
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          C4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          C4
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W1/Assignment/C4W1_Assignment/" class="md-nav__link">
        C4W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W1/Labs/C4_W1_Lab_1_Neural_Style_Transfer/" class="md-nav__link">
        C4 W1 Lab 1 Neural Style Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W1/Labs/C4_W1_Lab_2_Fast_NST/" class="md-nav__link">
        C4 W1 Lab 2 Fast NST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W2/Assignment/C4W2_Assignment/" class="md-nav__link">
        C4W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W2/Labs/C4_W2_Lab_1_FirstAutoEncoder/" class="md-nav__link">
        C4 W2 Lab 1 FirstAutoEncoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W2/Labs/C4_W2_Lab_2_MNIST_Autoencoder/" class="md-nav__link">
        C4 W2 Lab 2 MNIST Autoencoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W2/Labs/C4_W2_Lab_3_MNIST_DeepAutoencoder/" class="md-nav__link">
        C4 W2 Lab 3 MNIST DeepAutoencoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W2/Labs/C4_W2_Lab_4_FashionMNIST_CNNAutoEncoder/" class="md-nav__link">
        C4 W2 Lab 4 FashionMNIST CNNAutoEncoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W2/Labs/C4_W2_Lab_5_FashionMNIST_NoisyCNNAutoEncoder/" class="md-nav__link">
        C4 W2 Lab 5 FashionMNIST NoisyCNNAutoEncoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W3/Assignment/C4W3_Assignment/" class="md-nav__link">
        C4W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W3/Labs/C4_W3_Lab_1_VAE_MNIST/" class="md-nav__link">
        C4 W3 Lab 1 VAE MNIST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W4/Assignment/C4W4_Assignment/" class="md-nav__link">
        C4W4 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W4/Labs/C4_W4_Lab_1_First_GAN/" class="md-nav__link">
        C4 W4 Lab 1 First GAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W4/Labs/C4_W4_Lab_2_First_DCGAN/" class="md-nav__link">
        C4 W4 Lab 2 First DCGAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../TF_Specialization/C4/W4/Labs/C4_W4_Lab_3_CelebA_GAN_Experiments/" class="md-nav__link">
        C4 W4 Lab 3 CelebA GAN Experiments
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Generative Adversarial Networks Specialization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Generative Adversarial Networks Specialization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
      
      
      
        <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
          C1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          C1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W1/Assignments/C1W1_Your_First_GAN/" class="md-nav__link">
        C1W1 Your First GAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W1/Labs/Intro_to_PyTorch/" class="md-nav__link">
        Intro to PyTorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W2/Assignments/C1_W2_Assignment/" class="md-nav__link">
        C1 W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W2/Labs/C1W2_Video_Generation_%28Optional%29/" class="md-nav__link">
        C1W2 Video Generation (Optional)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W3/Assignments/C1W3_WGAN_GP/" class="md-nav__link">
        C1W3 WGAN GP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W3/Labs/SNGAN/" class="md-nav__link">
        SNGAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W4/Assignments/C1W4A_Build_a_Conditional_GAN/" class="md-nav__link">
        C1W4A Build a Conditional GAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C1/W4/Assignments/C1W4B_Controllable_Generation/" class="md-nav__link">
        C1W4B Controllable Generation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
      
      
      
        <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
          C2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          C2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W1/Assignments/C2W1_Assignment/" class="md-nav__link">
        C2W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W1/Labs/PPL/" class="md-nav__link">
        PPL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W2/Assignments/C2W2_Assignment/" class="md-nav__link">
        C2W2 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W2/Labs/C2W2_VAE/" class="md-nav__link">
        C2W2 VAE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W3/Assignments/C2W3_Assignment/" class="md-nav__link">
        C2W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W3/Labs/BigGAN/" class="md-nav__link">
        BigGAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C2/W3/Labs/StyleGAN2/" class="md-nav__link">
        StyleGAN2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
      
      
      
        <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
          C3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          C3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W1/Assignments/C3W1_Assignment/" class="md-nav__link">
        C3W1 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W1/Labs/C3W1_Generative_Teaching_Networks_%28Optional%29/" class="md-nav__link">
        C3W1 Generative Teaching Networks (Optional)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W2/Assignments/C3W2A_Assignment/" class="md-nav__link">
        C3W2A Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W2/Assignments/C3W2B_Assignment/" class="md-nav__link">
        C3W2B Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W2/Labs/C3W2_GauGAN_%28Optional%29/" class="md-nav__link">
        C3W2 GauGAN (Optional)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W2/Labs/C3W2_Pix2PixHD_%28Optional%29/" class="md-nav__link">
        C3W2 Pix2PixHD (Optional)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W3/Assignments/C3W3_Assignment/" class="md-nav__link">
        C3W3 Assignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GAN/C3/W3/Labs/C3W3_MUNIT_%28Optional%29/" class="md-nav__link">
        C3W3 MUNIT (Optional)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Deep Learning AI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Deep Learning AI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          How Diffusion Models Work
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          How Diffusion Models Work
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Diffusion/Lab1/L1_Sampling/" class="md-nav__link">
        L1 Sampling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Diffusion/Lab2/L2_Training/" class="md-nav__link">
        L2 Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Diffusion/Lab3/L3_Context/" class="md-nav__link">
        L3 Context
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Diffusion/Lab4/L4_FastSampling/" class="md-nav__link">
        L4 FastSampling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
      
      
      
        <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
          LangChain for LLM Application Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          LangChain for LLM Application Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Langchain/L1-Model_prompt_parser/" class="md-nav__link">
        L1 Model prompt parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Langchain/L2-Memory/" class="md-nav__link">
        L2 Memory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Langchain/L3-Chains/" class="md-nav__link">
        L3 Chains
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Langchain/L4-QnA/" class="md-nav__link">
        L4 QnA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Langchain/L5-Evaluation/" class="md-nav__link">
        L5 Evaluation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Langchain/L6-Agents/" class="md-nav__link">
        L6 Agents
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
      
      
      
        <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
          ChatGPT Prompt Engineering for Developers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          ChatGPT Prompt Engineering for Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Prompt/l2-guidelines/" class="md-nav__link">
        L2 guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Prompt/l4-summarizing/" class="md-nav__link">
        L4 summarizing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Prompt/l5-inferring/" class="md-nav__link">
        L5 inferring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Prompt/l6-transforming/" class="md-nav__link">
        L6 transforming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Prompt/l7-expanding/" class="md-nav__link">
        L7 expanding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Prompt/l8-chatbot/" class="md-nav__link">
        L8 chatbot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
      
      
      
        <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
          Building Systems with the ChatGPT API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Building Systems with the ChatGPT API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/1_Language_Models%2C_the_Chat_Format_and_Tokens/" class="md-nav__link">
        1 Language Models, the Chat Format and Tokens
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/2_Classification/" class="md-nav__link">
        2 Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/3_Moderation/" class="md-nav__link">
        3 Moderation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/4_Chain_of_Thoughts/" class="md-nav__link">
        4 Chain of Thoughts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/5_Chaining_Prompts/" class="md-nav__link">
        5 Chaining Prompts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/6_Check_Outputs/" class="md-nav__link">
        6 Check Outputs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/7_Build_an_End_to_End_System/" class="md-nav__link">
        7 Build an End to End System
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/8_Evaluation_Part_1/" class="md-nav__link">
        8 Evaluation Part 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DLAI/Building_System/9_Evaluation_Part_2/" class="md-nav__link">
        9 Evaluation Part 2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table align="left" class="tfo-notebook-buttons">
<td style="border: none;">
<a target='blank' href='https://colab.research.google.com/github/Hari31416/Data-Sciences/blob/main/Notes/DLS/C5/Assignments/Dinosaurus_Island_Character_level_language_model/Dinosaurus_Island_Character_level_language_model.ipynb?hl=en'><img src='https://colab.research.google.com/img/colab_favicon_256px.png' width='28' height='28'/>Run on Google Colab</a></td>
<td style="border: none;">
<a target='blank' href='https://github.com/Hari31416/Data-Sciences/blob/main/Notes/DLS/C5/Assignments/Dinosaurus_Island_Character_level_language_model/Dinosaurus_Island_Character_level_language_model.ipynb'><img src='https://cdn.icon-icons.com/icons2/2368/PNG/512/github_logo_icon_143772.png' width='28' height='28'/>View on Github</a></td>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="character-level-language-model-dinosaurus-island">Character level language model - Dinosaurus Island</h1>
<p>Welcome to Dinosaurus Island! 65 million years ago, dinosaurs existed, and in this assignment, they have returned. </p>
<p>You are in charge of a special task: Leading biology researchers are creating new breeds of dinosaurs and bringing them to life on earth, and your job is to give names to these dinosaurs. If a dinosaur does not like its name, it might go berserk, so choose wisely! </p>
<table>
<td>
<img src="images/dino.jpg" style="width:250;height:300px;">

</td>
</table>
<p>Luckily you're equipped with some deep learning now, and you will use it to save the day! Your assistant has collected a list of all the dinosaur names they could find, and compiled them into this <a href="dinos.txt">dataset</a>. (Feel free to take a look by clicking the previous link.) To create new dinosaur names, you will build a character-level language model to generate new names. Your algorithm will learn the different name patterns, and randomly generate new names. Hopefully this algorithm will keep you and your team safe from the dinosaurs' wrath! </p>
<p>By the time you complete this assignment, you'll be able to:</p>
<ul>
<li>Store text data for processing using an RNN </li>
<li>Build a character-level text generation model using an RNN</li>
<li>Sample novel sequences in an RNN</li>
<li>Explain the vanishing/exploding gradient problem in RNNs</li>
<li>Apply gradient clipping as a solution for exploding gradients</li>
</ul>
<p>Begin by loading in some functions that are provided for you in <code>rnn_utils</code>. Specifically, you have access to functions such as <code>rnn_forward</code> and <code>rnn_backward</code> which are equivalent to those you've implemented in the previous assignment. </p>
<h2 id="important-note-on-submission-to-the-autograder">Important Note on Submission to the AutoGrader</h2>
<p>Before submitting your assignment to the AutoGrader, please make sure you are not doing the following:</p>
<ol>
<li>You have not added any <em>extra</em> <code>print</code> statement(s) in the assignment.</li>
<li>You have not added any <em>extra</em> code cell(s) in the assignment.</li>
<li>You have not changed any of the function parameters.</li>
<li>You are not using any global variables inside your graded exercises. Unless specifically instructed to do so, please refrain from it and use the local variables instead.</li>
<li>You are not changing the assignment code where it is not required, like creating <em>extra</em> variables.</li>
</ol>
<p>If you do any of the following, you will get something like, <code>Grader not found</code> (or similarly unexpected) error upon submitting your assignment. Before asking for help/debugging the errors in your assignment, check for these first. If this is the case, and you don't remember the changes you have made, you can get a fresh copy of the assignment by following these <a href="https://www.coursera.org/learn/nlp-sequence-models/supplement/qHIve/h-ow-to-refresh-your-workspace">instructions</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#0">Packages</a></li>
<li><a href="#1">1 - Problem Statement</a><ul>
<li><a href="#1-1">1.1 - Dataset and Preprocessing</a></li>
<li><a href="#1-2">1.2 - Overview of the Model</a></li>
</ul>
</li>
<li><a href="#2">2 - Building Blocks of the Model</a><ul>
<li><a href="#2-1">2.1 - Clipping the Gradients in the Optimization Loop</a><ul>
<li><a href="#ex-1">Exercise 1 - clip</a></li>
</ul>
</li>
<li><a href="#2-2">2.2 - Sampling</a><ul>
<li><a href="#ex-2">Exercise 2 - sample</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3">3 - Building the Language Model</a><ul>
<li><a href="#3-1">3.1 - Gradient Descent</a><ul>
<li><a href="#ex-3">Exercise 3 - optimize</a></li>
</ul>
</li>
<li><a href="#3-2">3.2 - Training the Model</a><ul>
<li><a href="#ex-4">Exercise 4 - model</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4">4 - Writing like Shakespeare (OPTIONAL/UNGRADED)</a></li>
<li><a href="#5">5 - References</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='0'></a></p>
<h2 id="packages">Packages</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">copy</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='1'></a></p>
<h2 id="1-problem-statement">1 - Problem Statement</h2>
<p><a name='1-1'></a></p>
<h3 id="11-dataset-and-preprocessing">1.1 - Dataset and Preprocessing</h3>
<p>Run the following cell to read the dataset of dinosaur names, create a list of unique characters (such as a-z), and compute the dataset and vocabulary size. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dinos.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">data</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">data_size</span><span class="p">,</span> <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are </span><span class="si">%d</span><span class="s1"> total characters and </span><span class="si">%d</span><span class="s1"> unique characters in your data.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data_size</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">))</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>There are 19909 total characters and 27 unique characters in your data.
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The characters are a-z (26 characters) plus the "\n" (or newline character).</li>
<li>In this assignment, the newline character "\n" plays a role similar to the <code>&lt;EOS&gt;</code> (or "End of sentence") token discussed in lecture.  <ul>
<li>Here, "\n" indicates the end of the dinosaur name rather than the end of a sentence. </li>
</ul>
</li>
<li><code>char_to_ix</code>: In the cell below, you'll create a Python dictionary (i.e., a hash table) to map each character to an index from 0-26.</li>
<li><code>ix_to_char</code>: Then, you'll create a second Python dictionary that maps each index back to the corresponding character. <ul>
<li>This will help you figure out which index corresponds to which character in the probability distribution output of the softmax layer. </li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">chars</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>[&#39;\n&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;]
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">char_to_ix</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ch</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="p">}</span>
<span class="n">ix_to_char</span> <span class="o">=</span> <span class="p">{</span> <span class="n">i</span><span class="p">:</span><span class="n">ch</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="p">}</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">ix_to_char</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>{   0: &#39;\n&#39;,
    1: &#39;a&#39;,
    2: &#39;b&#39;,
    3: &#39;c&#39;,
    4: &#39;d&#39;,
    5: &#39;e&#39;,
    6: &#39;f&#39;,
    7: &#39;g&#39;,
    8: &#39;h&#39;,
    9: &#39;i&#39;,
    10: &#39;j&#39;,
    11: &#39;k&#39;,
    12: &#39;l&#39;,
    13: &#39;m&#39;,
    14: &#39;n&#39;,
    15: &#39;o&#39;,
    16: &#39;p&#39;,
    17: &#39;q&#39;,
    18: &#39;r&#39;,
    19: &#39;s&#39;,
    20: &#39;t&#39;,
    21: &#39;u&#39;,
    22: &#39;v&#39;,
    23: &#39;w&#39;,
    24: &#39;x&#39;,
    25: &#39;y&#39;,
    26: &#39;z&#39;}
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='1-2'></a></p>
<h3 id="12-overview-of-the-model">1.2 - Overview of the Model</h3>
<p>Your model will have the following structure: </p>
<ul>
<li>Initialize parameters </li>
<li>Run the optimization loop<ul>
<li>Forward propagation to compute the loss function</li>
<li>Backward propagation to compute the gradients with respect to the loss function</li>
<li>Clip the gradients to avoid exploding gradients</li>
<li>Using the gradients, update your parameters with the gradient descent update rule.</li>
</ul>
</li>
<li>Return the learned parameters </li>
</ul>
<p><img src="images/rnn.png" style="width:450;height:300px;">
<caption><center><font color='purple'><b>Figure 1</b>: Recurrent Neural Network, similar to what you built in the previous notebook "Building a Recurrent Neural Network - Step by Step."  </center></caption></p>
<ul>
<li>At each time-step, the RNN tries to predict what the next character is, given the previous characters. </li>
<li><span class="arithmatex">\(\mathbf{X} = (x^{\langle 1 \rangle}, x^{\langle 2 \rangle}, ..., x^{\langle T_x \rangle})\)</span> is a list of characters from the training set.</li>
<li><span class="arithmatex">\(\mathbf{Y} = (y^{\langle 1 \rangle}, y^{\langle 2 \rangle}, ..., y^{\langle T_x \rangle})\)</span> is the same list of characters but shifted one character forward. </li>
<li>At every time-step <span class="arithmatex">\(t\)</span>, <span class="arithmatex">\(y^{\langle t \rangle} = x^{\langle t+1 \rangle}\)</span>.  The prediction at time <span class="arithmatex">\(t\)</span> is the same as the input at time <span class="arithmatex">\(t + 1\)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='2'></a></p>
<h2 id="2-building-blocks-of-the-model">2 - Building Blocks of the Model</h2>
<p>In this part, you will build two important blocks of the overall model:</p>
<ol>
<li>Gradient clipping: to avoid exploding gradients</li>
<li>Sampling: a technique used to generate characters</li>
</ol>
<p>You will then apply these two functions to build the model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='2-1'></a></p>
<h3 id="21-clipping-the-gradients-in-the-optimization-loop">2.1 - Clipping the Gradients in the Optimization Loop</h3>
<p>In this section you will implement the <code>clip</code> function that you will call inside of your optimization loop. </p>
<h4 id="exploding-gradients">Exploding gradients</h4>
<ul>
<li>When gradients are very large, they're called "exploding gradients."  </li>
<li>Exploding gradients make the training process more difficult, because the updates may be so large that they "overshoot" the optimal values during back propagation.</li>
</ul>
<p>Recall that your overall loop structure usually consists of:
* forward pass, 
* cost computation, 
* backward pass, 
* parameter update. </p>
<p>Before updating the parameters, you will perform gradient clipping to make sure that your gradients are not "exploding."</p>
<h4 id="gradient-clipping">Gradient clipping</h4>
<p>In the exercise below, you will implement a function <code>clip</code> that takes in a dictionary of gradients and returns a clipped version of gradients, if needed. </p>
<ul>
<li>There are different ways to clip gradients.</li>
<li>You will use a simple element-wise clipping procedure, in which every element of the gradient vector is clipped to fall between some range [-N, N]. </li>
<li>For example, if the N=10<ul>
<li>The range is [-10, 10]</li>
<li>If any component of the gradient vector is greater than 10, it is set to 10.</li>
<li>If any component of the gradient vector is less than -10, it is set to -10. </li>
<li>If any components are between -10 and 10, they keep their original values.</li>
</ul>
</li>
</ul>
<p><img src="images/clip.png" style="width:400;height:150px;">
<caption><center><font color='purple'><b>Figure 2</b>: Visualization of gradient descent with and without gradient clipping, in a case where the network is running into "exploding gradient" problems. </center></caption></p>
<p><a name='ex-1'></a></p>
<h3 id="exercise-1-clip">Exercise 1 - clip</h3>
<p>Return the clipped gradients of your dictionary <code>gradients</code>. </p>
<ul>
<li>Your function takes in a maximum threshold and returns the clipped versions of the gradients. </li>
<li>You can check out <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.clip.html">numpy.clip</a> for more info. <ul>
<li>You will need to use the argument "<code>out = ...</code>".</li>
<li>Using the "<code>out</code>" parameter allows you to update a variable "in-place".</li>
<li>If you don't use "<code>out</code>" argument, the clipped variable is stored in the variable "gradient" but does not update the gradient variables <code>dWax</code>, <code>dWaa</code>, <code>dWya</code>, <code>db</code>, <code>dby</code>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># UNQ_C1 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1">### GRADED FUNCTION: clip</span>

<span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="n">gradients</span><span class="p">,</span> <span class="n">maxValue</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Clips the gradients&#39; values between minimum and maximum.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    gradients -- a dictionary containing the gradients &quot;dWaa&quot;, &quot;dWax&quot;, &quot;dWya&quot;, &quot;db&quot;, &quot;dby&quot;</span>
<span class="sd">    maxValue -- everything above this number is set to this number, and everything less than -maxValue is set to -maxValue</span>

<span class="sd">    Returns: </span>
<span class="sd">    gradients -- a dictionary with the clipped gradients.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">gradients</span><span class="p">)</span>

    <span class="n">dWaa</span><span class="p">,</span> <span class="n">dWax</span><span class="p">,</span> <span class="n">dWya</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">dby</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;dWaa&#39;</span><span class="p">],</span> <span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;dWax&#39;</span><span class="p">],</span> <span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;dWya&#39;</span><span class="p">],</span> <span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;dby&#39;</span><span class="p">]</span>

    <span class="c1">### START CODE HERE ###</span>
    <span class="c1"># Clip to mitigate exploding gradients, loop over [dWax, dWaa, dWya, db, dby]. (≈2 lines)</span>
    <span class="k">for</span> <span class="n">gradient</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dWax</span><span class="p">,</span> <span class="n">dWaa</span><span class="p">,</span> <span class="n">dWya</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">dby</span><span class="p">]:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">gradient</span><span class="p">,</span> <span class="o">-</span><span class="n">maxValue</span><span class="p">,</span> <span class="n">maxValue</span><span class="p">,</span> <span class="n">out</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">)</span>
    <span class="c1">### END CODE HERE ###</span>

    <span class="n">gradients</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dWaa&quot;</span><span class="p">:</span> <span class="n">dWaa</span><span class="p">,</span> <span class="s2">&quot;dWax&quot;</span><span class="p">:</span> <span class="n">dWax</span><span class="p">,</span> <span class="s2">&quot;dWya&quot;</span><span class="p">:</span> <span class="n">dWya</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span><span class="p">:</span> <span class="n">db</span><span class="p">,</span> <span class="s2">&quot;dby&quot;</span><span class="p">:</span> <span class="n">dby</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">gradients</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># Test with a max value of 10</span>
<span class="k">def</span> <span class="nf">clip_test</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">mValue</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Gradients for mValue=</span><span class="si">{</span><span class="n">mValue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">dWax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="n">dWaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="n">dWya</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="n">dby</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dWax&quot;</span><span class="p">:</span> <span class="n">dWax</span><span class="p">,</span> <span class="s2">&quot;dWaa&quot;</span><span class="p">:</span> <span class="n">dWaa</span><span class="p">,</span> <span class="s2">&quot;dWya&quot;</span><span class="p">:</span> <span class="n">dWya</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span><span class="p">:</span> <span class="n">db</span><span class="p">,</span> <span class="s2">&quot;dby&quot;</span><span class="p">:</span> <span class="n">dby</span><span class="p">}</span>

    <span class="n">gradients2</span> <span class="o">=</span> <span class="n">target</span><span class="p">(</span><span class="n">gradients</span><span class="p">,</span> <span class="n">mValue</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dWaa</span><span class="se">\&quot;</span><span class="s2">][1][2] =&quot;</span><span class="p">,</span> <span class="n">gradients2</span><span class="p">[</span><span class="s2">&quot;dWaa&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dWax</span><span class="se">\&quot;</span><span class="s2">][3][1] =&quot;</span><span class="p">,</span> <span class="n">gradients2</span><span class="p">[</span><span class="s2">&quot;dWax&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dWya</span><span class="se">\&quot;</span><span class="s2">][1][2] =&quot;</span><span class="p">,</span> <span class="n">gradients2</span><span class="p">[</span><span class="s2">&quot;dWya&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">db</span><span class="se">\&quot;</span><span class="s2">][4] =&quot;</span><span class="p">,</span> <span class="n">gradients2</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dby</span><span class="se">\&quot;</span><span class="s2">][1] =&quot;</span><span class="p">,</span> <span class="n">gradients2</span><span class="p">[</span><span class="s2">&quot;dby&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">grad</span> <span class="ow">in</span> <span class="n">gradients2</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">valuei</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">[</span><span class="n">grad</span><span class="p">]</span>
        <span class="n">valuef</span> <span class="o">=</span> <span class="n">gradients2</span><span class="p">[</span><span class="n">grad</span><span class="p">]</span>
        <span class="n">mink</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">valuef</span><span class="p">)</span>
        <span class="n">maxk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">valuef</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">mink</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">mValue</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Problem with </span><span class="si">{</span><span class="n">grad</span><span class="si">}</span><span class="s2">. Set a_min to -mValue in the np.clip call&quot;</span>
        <span class="k">assert</span> <span class="n">maxk</span> <span class="o">&lt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mValue</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Problem with </span><span class="si">{</span><span class="n">grad</span><span class="si">}</span><span class="s2">.Set a_max to mValue in the np.clip call&quot;</span>
        <span class="n">index_not_clipped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">valuei</span> <span class="o">&lt;=</span> <span class="n">mValue</span><span class="p">,</span> <span class="n">valuei</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">mValue</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">valuei</span><span class="p">[</span><span class="n">index_not_clipped</span><span class="p">]</span> <span class="o">==</span> <span class="n">valuef</span><span class="p">[</span><span class="n">index_not_clipped</span><span class="p">]),</span> <span class="sa">f</span><span class="s2">&quot; Problem with </span><span class="si">{</span><span class="n">grad</span><span class="si">}</span><span class="s2">. Some values that should not have changed, changed during the clipping process.&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[92mAll tests passed!</span><span class="se">\x1b</span><span class="s2">[0m&quot;</span><span class="p">)</span>

<span class="n">clip_test</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">clip_test</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>
Gradients for mValue=10
gradients[&#34;dWaa&#34;][1][2] = 10.0
gradients[&#34;dWax&#34;][3][1] = -10.0
gradients[&#34;dWya&#34;][1][2] = 0.2971381536101662
gradients[&#34;db&#34;][4] = [10.]
gradients[&#34;dby&#34;][1] = [8.45833407]
<span class="ansi-green-intense-fg">All tests passed!</span>

Gradients for mValue=5
gradients[&#34;dWaa&#34;][1][2] = 5.0
gradients[&#34;dWax&#34;][3][1] = -5.0
gradients[&#34;dWya&#34;][1][2] = 0.2971381536101662
gradients[&#34;db&#34;][4] = [5.]
gradients[&#34;dby&#34;][1] = [5.]
<span class="ansi-green-intense-fg">All tests passed!</span>
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Expected values</strong>
<div class="highlight"><pre><span></span><code>Gradients for mValue=10
gradients[&quot;dWaa&quot;][1][2] = 10.0
gradients[&quot;dWax&quot;][3][1] = -10.0
gradients[&quot;dWya&quot;][1][2] = 0.2971381536101662
gradients[&quot;db&quot;][4] = [10.]
gradients[&quot;dby&quot;][1] = [8.45833407]

Gradients for mValue=5
gradients[&quot;dWaa&quot;][1][2] = 5.0
gradients[&quot;dWax&quot;][3][1] = -5.0
gradients[&quot;dWya&quot;][1][2] = 0.2971381536101662
gradients[&quot;db&quot;][4] = [5.]
gradients[&quot;dby&quot;][1] = [5.]
</code></pre></div></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='2-2'></a></p>
<h3 id="22-sampling">2.2 - Sampling</h3>
<p>Now, assume that your model is trained, and you would like to generate new text (characters). The process of generation is explained in the picture below:</p>
<p><img src="images/dinos3.png" style="width:500;height:300px;">
<caption><center><font color='purple'><b>Figure 3</b>: In this picture, you can assume the model is already trained. You pass in <span class="arithmatex">\(x^{\langle 1\rangle} = \vec{0}\)</span> at the first time-step, and have the network sample one character at a time. </center></caption></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='ex-2'></a></p>
<h3 id="exercise-2-sample">Exercise 2 - sample</h3>
<p>Implement the <code>sample</code> function below to sample characters. </p>
<p>You need to carry out 4 steps:</p>
<ul>
<li><strong>Step 1</strong>: Input the "dummy" vector of zeros <span class="arithmatex">\(x^{\langle 1 \rangle} = \vec{0}\)</span>. <ul>
<li>This is the default input before you've generated any characters. 
You also set <span class="arithmatex">\(a^{\langle 0 \rangle} = \vec{0}\)</span></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Step 2</strong>: Run one step of forward propagation to get <span class="arithmatex">\(a^{\langle 1 \rangle}\)</span> and <span class="arithmatex">\(\hat{y}^{\langle 1 \rangle}\)</span>. Here are the equations:</li>
</ul>
<p><em>hidden state:</em><br />
$$ a^{\langle t+1 \rangle} = \tanh(W_{ax}  x^{\langle t+1 \rangle } + W_{aa} a^{\langle t \rangle } + b)\tag{1}$$</p>
<p><em>activation:</em>
$$ z^{\langle t + 1 \rangle } = W_{ya}  a^{\langle t + 1 \rangle } + b_y \tag{2}$$</p>
<p><em>prediction:</em>
$$ \hat{y}^{\langle t+1 \rangle } = softmax(z^{\langle t + 1 \rangle })\tag{3}$$</p>
<ul>
<li>Details about <span class="arithmatex">\(\hat{y}^{\langle t+1 \rangle }\)</span>:</li>
<li>Note that <span class="arithmatex">\(\hat{y}^{\langle t+1 \rangle }\)</span> is a (softmax) probability vector (its entries are between 0 and 1 and sum to 1). </li>
<li><span class="arithmatex">\(\hat{y}^{\langle t+1 \rangle}_i\)</span> represents the probability that the character indexed by "i" is the next character.  </li>
<li>A <code>softmax()</code> function is provided for you to use.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<details>
    <summary><h4 style="color: green;">Additional Hints: Matrix multiplication with numpy<h4></summary>

<body>
    <li>$x^{\langle 1 \rangle}$ is `x` in the code. When creating the one-hot vector, make a numpy array of zeros, with the number of rows equal to the number of unique characters, and the number of columns equal to one.  It's a 2D and not a 1D array.
    </li>
    <li>$a^{\langle 0 \rangle}$ is `a_prev` in the code.  It is a numpy array of zeros, where the number of rows is $n_{a}$, and number of columns is 1.  It is a 2D array as well.  $n_{a}$ is retrieved by getting the number of columns in $W_{aa}$ (the numbers need to match in order for the matrix multiplication $W_{aa}a^{\langle t \rangle}$ to work.
    </li>
    <li>Official documentation for <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html">numpy.dot</a> and <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.tanh.html">numpy.tanh</a>.
    </li>
    <li>Below is some revision code for matrix multiplication
    </li>

</body>
<p>

<div class="highlight"><pre><span></span><code><span class="n">matrix1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span> <span class="c1"># (3,2)</span>
<span class="n">matrix2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span> <span class="c1"># (3,1) </span>
<span class="n">vector1D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># (2,) </span>
<span class="n">vector2D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># (2,1)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;matrix1 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">matrix1</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;matrix2 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">matrix2</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vector1D </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vector1D</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vector2D </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vector2D</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiply 2D and 1D arrays: result is a 1D array</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> 
      <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">vector1D</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiply 2D and 2D arrays: result is a 2D array</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> 
      <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">vector2D</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adding (3 x 1) vector to a (3 x 1) vector is a (3 x 1) vector</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;This is what we want here!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> 
      <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">vector2D</span><span class="p">)</span> <span class="o">+</span> <span class="n">matrix2</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adding a (3,) vector to a (3 x 1) vector</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;broadcasts the 1D array across the second dimension</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Not what we want here!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">vector1D</span><span class="p">)</span> <span class="o">+</span> <span class="n">matrix2</span>
     <span class="p">)</span>
</code></pre></div>
</p>
</details>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p><strong>Step 3</strong>: Sampling: </p>
<ul>
<li>Now that you have <span class="arithmatex">\(y^{\langle t+1 \rangle}\)</span>, you want to select the next letter in the dinosaur name. If you select the most probable, the model will always generate the same result given a starting letter. To make the results more interesting, use <code>np.random.choice</code> to select a next letter that is <em>likely</em>, but not always the same.</li>
<li>Pick the next character's <strong>index</strong> according to the probability distribution specified by <span class="arithmatex">\(\hat{y}^{\langle t+1 \rangle }\)</span>. </li>
<li>This means that if <span class="arithmatex">\(\hat{y}^{\langle t+1 \rangle }_i = 0.16\)</span>, you will pick the index "i" with 16% probability. </li>
<li>Use <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.random.choice.html">np.random.choice</a>.</li>
</ul>
<p>Example of how to use <code>np.random.choice()</code>:
<div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">)),</span> <span class="n">p</span> <span class="o">=</span> <span class="n">probs</span><span class="p">)</span>
</code></pre></div></p>
<ul>
<li>This means that you will pick the index (<code>idx</code>) according to the distribution: </li>
</ul>
<p><span class="arithmatex">\(P(index = 0) = 0.1, P(index = 1) = 0.0, P(index = 2) = 0.7, P(index = 3) = 0.2\)</span>.</p>
<ul>
<li>Note that the value that's set to <code>p</code> should be set to a 1D vector.</li>
<li>Also notice that <span class="arithmatex">\(\hat{y}^{\langle t+1 \rangle}\)</span>, which is <code>y</code> in the code, is a 2D array.</li>
<li>Also notice, while in your implementation, the first argument to <code>np.random.choice</code> is just an ordered list [0,1,.., vocab_len-1], it is <em>not</em> appropriate to use <code>char_to_ix.values()</code>. The <em>order</em> of values returned by a Python dictionary <code>.values()</code> call will be the same order as they are added to the dictionary. The grader may have a different order when it runs your routine than when you run it in your notebook.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="additional-hints">Additional Hints</h5>
<ul>
<li>Documentation for the built-in Python function <a href="https://docs.python.org/3/library/functions.html#func-range">range</a></li>
<li>
<p>Docs for <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ravel.html">numpy.ravel</a>, which takes a multi-dimensional array and returns its contents inside of a 1D vector.
<div class="highlight"><pre><span></span><code><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arr&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arr.ravel()&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="n">arr</span>
<span class="p">[[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">3</span> <span class="mi">4</span><span class="p">]]</span>
<span class="n">arr</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
</code></pre></div></p>
</li>
<li>
<p>Note that <code>append</code> is an "in-place" operation, which means the changes made by the method will remain after the call completes.  In other words, don't do this:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">fun_hobbies</span> <span class="o">=</span> <span class="n">fun_hobbies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;learning&#39;</span><span class="p">)</span>  <span class="c1">## Doesn&#39;t give you what you want!</span>
</code></pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Step 4</strong>: Update to <span class="arithmatex">\(x^{\langle t \rangle }\)</span> <ul>
<li>The last step to implement in <code>sample()</code> is to update the variable <code>x</code>, which currently stores <span class="arithmatex">\(x^{\langle t \rangle }\)</span>, with the value of <span class="arithmatex">\(x^{\langle t + 1 \rangle }\)</span>. </li>
<li>You will represent <span class="arithmatex">\(x^{\langle t + 1 \rangle }\)</span> by creating a one-hot vector corresponding to the character that you have chosen as your prediction. </li>
<li>You will then forward propagate <span class="arithmatex">\(x^{\langle t + 1 \rangle }\)</span> in Step 1 and keep repeating the process until you get a <code>"\n"</code> character, indicating that you have reached the end of the dinosaur name. </li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="additional-hints_1">Additional Hints</h5>
<ul>
<li>In order to reset <code>x</code> before setting it to the new one-hot vector, you'll want to set all the values to zero.<ul>
<li>You can either create a new numpy array: <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html">numpy.zeros</a></li>
<li>Or fill all values with a single number: <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.fill.html">numpy.ndarray.fill</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># UNQ_C2 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1"># GRADED FUNCTION: sample</span>

<span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">char_to_ix</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample a sequence of characters according to a sequence of probability distributions output of the RNN</span>

<span class="sd">    Arguments:</span>
<span class="sd">    parameters -- Python dictionary containing the parameters Waa, Wax, Wya, by, and b. </span>
<span class="sd">    char_to_ix -- Python dictionary mapping each character to an index.</span>
<span class="sd">    seed -- Used for grading purposes. Do not worry about it.</span>

<span class="sd">    Returns:</span>
<span class="sd">    indices -- A list of length n containing the indices of the sampled characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve parameters and relevant shapes from &quot;parameters&quot; dictionary</span>
    <span class="n">Waa</span><span class="p">,</span> <span class="n">Wax</span><span class="p">,</span> <span class="n">Wya</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Waa&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Wax&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Wya&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;by&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
    <span class="n">vocab_size</span> <span class="o">=</span> <span class="n">by</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#     print(&quot;Vocab Size&quot;, vocab_size)</span>
    <span class="n">n_a</span> <span class="o">=</span> <span class="n">Waa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#     print(&quot;Wax Shape&quot;, Wax.shape)</span>

    <span class="c1">### START CODE HERE ###</span>
    <span class="c1"># Step 1: Create the a zero vector x that can be used as the one-hot vector </span>
    <span class="c1"># Representing the first character (initializing the sequence generation). (≈1 line)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">vocab_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># Step 1&#39;: Initialize a_prev as zeros (≈1 line)</span>
    <span class="n">a_prev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Create an empty list of indices. This is the list which will contain the list of indices of the characters to generate (≈1 line)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># idx is the index of the one-hot vector x that is set to 1</span>
    <span class="c1"># All other positions in x are zero.</span>
    <span class="c1"># Initialize idx to -1</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 

    <span class="c1"># Loop over time-steps t. At each time-step:</span>
    <span class="c1"># Sample a character from a probability distribution </span>
    <span class="c1"># And append its index (`idx`) to the list &quot;indices&quot;. </span>
    <span class="c1"># You&#39;ll stop if you reach 50 characters </span>
    <span class="c1"># (which should be very unlikely with a well-trained model).</span>
    <span class="c1"># Setting the maximum number of characters helps with debugging and prevents infinite loops. </span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">newline_character</span> <span class="o">=</span> <span class="n">char_to_ix</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">idx</span> <span class="o">!=</span> <span class="n">newline_character</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">!=</span> <span class="mi">50</span><span class="p">):</span>

        <span class="c1"># Step 2: Forward propagate x using the equations (1), (2) and (3)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Wax</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Waa</span><span class="p">,</span> <span class="n">a_prev</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Wya</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">by</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c1"># For grading purposes</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">counter</span> <span class="o">+</span> <span class="n">seed</span><span class="p">)</span> 

        <span class="c1"># Step 3: Sample the index of a character within the vocabulary from the probability distribution y</span>
        <span class="c1"># (see additional hints above)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">)),</span> <span class="n">p</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="c1">#         print(idx)</span>
        <span class="c1"># Append the index to &quot;indices&quot;</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

        <span class="c1"># Step 4: Overwrite the input x with one that corresponds to the sampled index `idx`.</span>
        <span class="c1"># (see additional hints above)</span>
<span class="c1">#         print(y)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Update &quot;a_prev&quot; to be &quot;a&quot;</span>
        <span class="n">a_prev</span> <span class="o">=</span> <span class="n">a</span>

        <span class="c1"># for grading purposes</span>
        <span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">counter</span> <span class="o">+=</span><span class="mi">1</span>

    <span class="c1">### END CODE HERE ###</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mi">50</span><span class="p">):</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char_to_ix</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">indices</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sample_test</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">n_a</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span>
    <span class="n">Wax</span><span class="p">,</span> <span class="n">Waa</span><span class="p">,</span> <span class="n">Wya</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="n">n_a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">n_a</span><span class="p">)</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Wax&quot;</span><span class="p">:</span> <span class="n">Wax</span><span class="p">,</span> <span class="s2">&quot;Waa&quot;</span><span class="p">:</span> <span class="n">Waa</span><span class="p">,</span> <span class="s2">&quot;Wya&quot;</span><span class="p">:</span> <span class="n">Wya</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;by&quot;</span><span class="p">:</span> <span class="n">by</span><span class="p">}</span>


    <span class="n">indices</span> <span class="o">=</span> <span class="n">target</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">char_to_ix</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sampling:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;list of sampled indices:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;list of sampled characters:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">ix_to_char</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">])</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">52</span><span class="p">,</span> <span class="s2">&quot;Indices lenght must be smaller than 52&quot;</span>
    <span class="k">assert</span> <span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">char_to_ix</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">],</span> <span class="s2">&quot;All samples must end with </span><span class="se">\\</span><span class="s2">n&quot;</span>
    <span class="k">assert</span> <span class="nb">min</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_to_ix</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Sampled indexes must be between 0 and len(char_to_ix)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">char_to_ix</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="s2">&quot;Wrong values&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[92mAll tests passed!&quot;</span><span class="p">)</span>

<span class="n">sample_test</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Sampling:
list of sampled indices:
 [23, 16, 26, 26, 24, 3, 21, 1, 7, 24, 15, 3, 25, 20, 6, 13, 10, 8, 20, 12, 2, 0]
list of sampled characters:
 [&#39;w&#39;, &#39;p&#39;, &#39;z&#39;, &#39;z&#39;, &#39;x&#39;, &#39;c&#39;, &#39;u&#39;, &#39;a&#39;, &#39;g&#39;, &#39;x&#39;, &#39;o&#39;, &#39;c&#39;, &#39;y&#39;, &#39;t&#39;, &#39;f&#39;, &#39;m&#39;, &#39;j&#39;, &#39;h&#39;, &#39;t&#39;, &#39;l&#39;, &#39;b&#39;, &#39;\n&#39;]
<span class="ansi-green-intense-fg">All tests passed!
</span></code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Expected output</strong>
<div class="highlight"><pre><span></span><code>Sampling:
list of sampled indices:
 [23, 16, 26, 26, 24, 3, 21, 1, 7, 24, 15, 3, 25, 20, 6, 13, 10, 8, 20, 12, 2, 0]
list of sampled characters:
 [&#39;w&#39;, &#39;p&#39;, &#39;z&#39;, &#39;z&#39;, &#39;x&#39;, &#39;c&#39;, &#39;u&#39;, &#39;a&#39;, &#39;g&#39;, &#39;x&#39;, &#39;o&#39;, &#39;c&#39;, &#39;y&#39;, &#39;t&#39;, &#39;f&#39;, &#39;m&#39;, &#39;j&#39;, &#39;h&#39;, &#39;t&#39;, &#39;l&#39;, &#39;b&#39;, &#39;\n&#39;]
</code></pre></div></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><font color='blue'><b>What you should remember</b>: 
* Very large, or "exploding" gradients updates can be so large that they "overshoot" the optimal values during back prop -- making training difficult 
    * Clip gradients before updating the parameters to avoid exploding gradients 
* Sampling is a technique you can use to pick the index of the next character according to a probability distribution.
    * To begin character-level sampling: 
        * Input a "dummy" vector of zeros as a default input 
        * Run one step of forward propagation to get 𝑎⟨1⟩ (your first character) and 𝑦̂ ⟨1⟩ (probability distribution for the following character) 
        * When sampling, avoid generating the same result each time given the starting letter (and make your names more interesting!) by using <code>np.random.choice</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='3'></a></p>
<h2 id="3-building-the-language-model">3 - Building the Language Model</h2>
<p>It's time to build the character-level language model for text generation! </p>
<p><a name='3-1'></a></p>
<h3 id="31-gradient-descent">3.1 - Gradient Descent</h3>
<p>In this section you will implement a function performing one step of stochastic gradient descent (with clipped gradients). You'll go through the training examples one at a time, so the optimization algorithm will be stochastic gradient descent. </p>
<p>As a reminder, here are the steps of a common optimization loop for an RNN:</p>
<ul>
<li>Forward propagate through the RNN to compute the loss</li>
<li>Backward propagate through time to compute the gradients of the loss with respect to the parameters</li>
<li>Clip the gradients</li>
<li>Update the parameters using gradient descent </li>
</ul>
<p><a name='ex-3'></a></p>
<h3 id="exercise-3-optimize">Exercise 3 - optimize</h3>
<p>Implement the optimization process (one step of stochastic gradient descent).</p>
<p>The following functions are provided:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rnn_forward</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">a_prev</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Performs the forward propagation through the RNN and computes the cross-entropy loss.</span>
<span class="sd">    It returns the loss&#39; value as well as a &quot;cache&quot; storing values to be used in backpropagation.&quot;&quot;&quot;</span>
    <span class="o">....</span>
    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">cache</span>

<span class="k">def</span> <span class="nf">rnn_backward</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cache</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Performs the backward propagation through time to compute the gradients of the loss with respect</span>
<span class="sd">    to the parameters. It returns also all the hidden states.&quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Updates parameters using the Gradient Descent Update Rule.&quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">parameters</span>
</code></pre></div>
<p>Recall that you previously implemented the <code>clip</code> function:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="parameters">Parameters</h4>
<ul>
<li>Note that the weights and biases inside the <code>parameters</code> dictionary are being updated by the optimization, even though <code>parameters</code> is not one of the returned values of the <code>optimize</code> function. The <code>parameters</code> dictionary is passed by reference into the function, so changes to this dictionary are making changes to the <code>parameters</code> dictionary even when accessed outside of the function.</li>
<li>Python dictionaries and lists are "pass by reference", which means that if you pass a dictionary into a function and modify the dictionary within the function, this changes that same dictionary (it's not a copy of the dictionary).</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># UNQ_C3 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1"># GRADED FUNCTION: optimize</span>

<span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">a_prev</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute one step of the optimization to train the model.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    X -- list of integers, where each integer is a number that maps to a character in the vocabulary.</span>
<span class="sd">    Y -- list of integers, exactly the same as X but shifted one index to the left.</span>
<span class="sd">    a_prev -- previous hidden state.</span>
<span class="sd">    parameters -- python dictionary containing:</span>
<span class="sd">                        Wax -- Weight matrix multiplying the input, numpy array of shape (n_a, n_x)</span>
<span class="sd">                        Waa -- Weight matrix multiplying the hidden state, numpy array of shape (n_a, n_a)</span>
<span class="sd">                        Wya -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)</span>
<span class="sd">                        b --  Bias, numpy array of shape (n_a, 1)</span>
<span class="sd">                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)</span>
<span class="sd">    learning_rate -- learning rate for the model.</span>

<span class="sd">    Returns:</span>
<span class="sd">    loss -- value of the loss function (cross-entropy)</span>
<span class="sd">    gradients -- python dictionary containing:</span>
<span class="sd">                        dWax -- Gradients of input-to-hidden weights, of shape (n_a, n_x)</span>
<span class="sd">                        dWaa -- Gradients of hidden-to-hidden weights, of shape (n_a, n_a)</span>
<span class="sd">                        dWya -- Gradients of hidden-to-output weights, of shape (n_y, n_a)</span>
<span class="sd">                        db -- Gradients of bias vector, of shape (n_a, 1)</span>
<span class="sd">                        dby -- Gradients of output bias vector, of shape (n_y, 1)</span>
<span class="sd">    a[len(X)-1] -- the last hidden state, of shape (n_a, 1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### START CODE HERE ###</span>

    <span class="c1"># Forward propagate through time (≈1 line)</span>
    <span class="n">loss</span><span class="p">,</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">rnn_forward</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">a_prev</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="c1"># Backpropagate through time (≈1 line)</span>
    <span class="n">gradients</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">rnn_backward</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>

    <span class="c1"># Clip your gradients between -5 (min) and 5 (max) (≈1 line)</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="n">clip</span><span class="p">(</span><span class="n">gradients</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Update parameters (≈1 line)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">update_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">)</span>

    <span class="c1">### END CODE HERE ###</span>

    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">optimize_test</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">vocab_size</span><span class="p">,</span> <span class="n">n_a</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">100</span>
    <span class="n">a_prev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Wax</span><span class="p">,</span> <span class="n">Waa</span><span class="p">,</span> <span class="n">Wya</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="n">n_a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">n_a</span><span class="p">)</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Wax&quot;</span><span class="p">:</span> <span class="n">Wax</span><span class="p">,</span> <span class="s2">&quot;Waa&quot;</span><span class="p">:</span> <span class="n">Waa</span><span class="p">,</span> <span class="s2">&quot;Wya&quot;</span><span class="p">:</span> <span class="n">Wya</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;by&quot;</span><span class="p">:</span> <span class="n">by</span><span class="p">}</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]</span>
    <span class="n">old_parameters</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">loss</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">a_last</span> <span class="o">=</span> <span class="n">target</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">a_prev</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loss =&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dWaa</span><span class="se">\&quot;</span><span class="s2">][1][2] =&quot;</span><span class="p">,</span> <span class="n">gradients</span><span class="p">[</span><span class="s2">&quot;dWaa&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;np.argmax(gradients[</span><span class="se">\&quot;</span><span class="s2">dWax</span><span class="se">\&quot;</span><span class="s2">]) =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">gradients</span><span class="p">[</span><span class="s2">&quot;dWax&quot;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dWya</span><span class="se">\&quot;</span><span class="s2">][1][2] =&quot;</span><span class="p">,</span> <span class="n">gradients</span><span class="p">[</span><span class="s2">&quot;dWya&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">db</span><span class="se">\&quot;</span><span class="s2">][4] =&quot;</span><span class="p">,</span> <span class="n">gradients</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gradients[</span><span class="se">\&quot;</span><span class="s2">dby</span><span class="se">\&quot;</span><span class="s2">][1] =&quot;</span><span class="p">,</span> <span class="n">gradients</span><span class="p">[</span><span class="s2">&quot;dby&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a_last[4] =&quot;</span><span class="p">,</span> <span class="n">a_last</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="mf">126.5039757</span><span class="p">),</span> <span class="s2">&quot;Problems with the call of the rnn_forward function&quot;</span>
    <span class="k">for</span> <span class="n">grad</span> <span class="ow">in</span> <span class="n">gradients</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">grad</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Problems in the clip function call&quot;</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">grad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Problems in the clip function call&quot;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;dWaa&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.1947093</span><span class="p">),</span> <span class="s2">&quot;Unexpected gradients. Check the rnn_backward call&quot;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">gradients</span><span class="p">[</span><span class="s1">&#39;dWya&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.007773876</span><span class="p">),</span> <span class="s2">&quot;Unexpected gradients. Check the rnn_backward call&quot;</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Wya&#39;</span><span class="p">],</span> <span class="n">old_parameters</span><span class="p">[</span><span class="s1">&#39;Wya&#39;</span><span class="p">]),</span> <span class="s2">&quot;parameters were not updated&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[92mAll tests passed!&quot;</span><span class="p">)</span>

<span class="n">optimize_test</span><span class="p">(</span><span class="n">optimize</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Loss = 126.50397572165389
gradients[&#34;dWaa&#34;][1][2] = 0.19470931534713587
np.argmax(gradients[&#34;dWax&#34;]) = 93
gradients[&#34;dWya&#34;][1][2] = -0.007773876032002162
gradients[&#34;db&#34;][4] = [-0.06809825]
gradients[&#34;dby&#34;][1] = [0.01538192]
a_last[4] = [-1.]
<span class="ansi-green-intense-fg">All tests passed!
</span></code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Expected output</strong></p>
<div class="highlight"><pre><span></span><code>Loss = 126.50397572165389
gradients[&quot;dWaa&quot;][1][2] = 0.19470931534713587
np.argmax(gradients[&quot;dWax&quot;]) = 93
gradients[&quot;dWya&quot;][1][2] = -0.007773876032002162
gradients[&quot;db&quot;][4] = [-0.06809825]
gradients[&quot;dby&quot;][1] = [0.01538192]
a_last[4] = [-1.]
</code></pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='3-2'></a></p>
<h3 id="32-training-the-model">3.2 - Training the Model</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Given the dataset of dinosaur names, you'll use each line of the dataset (one name) as one training example. </li>
<li>Every 2000 steps of stochastic gradient descent, you will sample several randomly chosen names to see how the algorithm is doing. </li>
</ul>
<p><a name='ex-4'></a></p>
<h3 id="exercise-4-model">Exercise 4 - model</h3>
<p>Implement <code>model()</code>. </p>
<p>When <code>examples[index]</code> contains one dinosaur name (string), to create an example (X, Y), you can use this:</p>
<h5 id="set-the-index-idx-into-the-list-of-examples">Set the index <code>idx</code> into the list of examples</h5>
<ul>
<li>Using the for-loop, walk through the shuffled list of dinosaur names in the list "examples."</li>
<li>For example, if there are n_e examples, and the for-loop increments the index to n_e onwards, think of how you would make the index cycle back to 0, so that you can continue feeding the examples into the model when j is n_e, n_e + 1, etc.</li>
<li>Hint: (n_e + 1) % n_e equals 1, which is otherwise the 'remainder' you get when you divide (n_e + 1) by n_e.</li>
<li><code>%</code> is the <a href="https://www.freecodecamp.org/news/the-python-modulo-operator-what-does-the-symbol-mean-in-python-solved/">modulo operator in python</a>.</li>
</ul>
<h5 id="extract-a-single-example-from-the-list-of-examples">Extract a single example from the list of examples</h5>
<ul>
<li><code>single_example</code>: use the <code>idx</code> index that you set previously to get one word from the list of examples.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="convert-a-string-into-a-list-of-characters-single_example_chars">Convert a string into a list of characters: <code>single_example_chars</code></h5>
<ul>
<li><code>single_example_chars</code>: A string is a list of characters.</li>
<li>You can use a list comprehension (recommended over for-loops) to generate a list of characters.
<div class="highlight"><pre><span></span><code><span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;I love learning&#39;</span>
<span class="n">list_of_chars</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">list_of_chars</span><span class="p">)</span>
</code></pre></div></li>
</ul>
<div class="highlight"><pre><span></span><code>[&#39;I&#39;, &#39; &#39;, &#39;l&#39;, &#39;o&#39;, &#39;v&#39;, &#39;e&#39;, &#39; &#39;, &#39;l&#39;, &#39;e&#39;, &#39;a&#39;, &#39;r&#39;, &#39;n&#39;, &#39;i&#39;, &#39;n&#39;, &#39;g&#39;]
</code></pre></div>
<ul>
<li>For more on <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">list comprehensions</a>:</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="convert-list-of-characters-to-a-list-of-integers-single_example_ix">Convert list of characters to a list of integers: <code>single_example_ix</code></h5>
<ul>
<li>Create a list that contains the index numbers associated with each character.</li>
<li>Use the dictionary <code>char_to_ix</code></li>
<li>You can combine this with the list comprehension that is used to get a list of characters from a string.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="create-the-list-of-input-characters-x">Create the list of input characters: <code>X</code></h5>
<ul>
<li><code>rnn_forward</code> uses the <strong><code>None</code></strong> value as a flag to set the input vector as a zero-vector.</li>
<li>Prepend the list [<strong><code>None</code></strong>] in front of the list of input characters.</li>
<li>There is more than one way to prepend a value to a list.  One way is to add two lists together: <code>['a'] + ['b']</code></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="get-the-integer-representation-of-the-newline-character-ix_newline">Get the integer representation of the newline character <code>ix_newline</code></h5>
<ul>
<li><code>ix_newline</code>: The newline character signals the end of the dinosaur name.<ul>
<li>Get the integer representation of the newline character <code>'\n'</code>.</li>
<li>Use <code>char_to_ix</code></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="set-the-list-of-labels-integer-representation-of-the-characters-y">Set the list of labels (integer representation of the characters): <code>Y</code></h5>
<ul>
<li>The goal is to train the RNN to predict the next letter in the name, so the labels are the list of characters that are one time-step ahead of the characters in the input <code>X</code>.<ul>
<li>For example, <code>Y[0]</code> contains the same value as <code>X[1]</code>  </li>
</ul>
</li>
<li>The RNN should predict a newline at the last letter, so add <code>ix_newline</code> to the end of the labels. <ul>
<li>Append the integer representation of the newline character to the end of <code>Y</code>.</li>
<li>Note that <code>append</code> is an in-place operation.</li>
<li>It might be easier for you to add two lists together.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># UNQ_C4 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1"># GRADED FUNCTION: model</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">data_x</span><span class="p">,</span> <span class="n">ix_to_char</span><span class="p">,</span> <span class="n">char_to_ix</span><span class="p">,</span> <span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">35000</span><span class="p">,</span> <span class="n">n_a</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">dino_names</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">vocab_size</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trains the model and generates dinosaur names. </span>

<span class="sd">    Arguments:</span>
<span class="sd">    data_x -- text corpus, divided in words</span>
<span class="sd">    ix_to_char -- dictionary that maps the index to a character</span>
<span class="sd">    char_to_ix -- dictionary that maps a character to an index</span>
<span class="sd">    num_iterations -- number of iterations to train the model for</span>
<span class="sd">    n_a -- number of units of the RNN cell</span>
<span class="sd">    dino_names -- number of dinosaur names you want to sample at each iteration. </span>
<span class="sd">    vocab_size -- number of unique characters found in the text (size of the vocabulary)</span>

<span class="sd">    Returns:</span>
<span class="sd">    parameters -- learned parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve n_x and n_y from vocab_size</span>
    <span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span> <span class="o">=</span> <span class="n">vocab_size</span><span class="p">,</span> <span class="n">vocab_size</span>

    <span class="c1"># Initialize parameters</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">initialize_parameters</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>

    <span class="c1"># Initialize loss (this is required because we want to smooth our loss)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">get_initial_loss</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">dino_names</span><span class="p">)</span>

    <span class="c1"># Build list of all dinosaur names (training examples).</span>
    <span class="n">examples</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_x</span><span class="p">]</span>

    <span class="c1"># Shuffle list of all dinosaur names</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>

    <span class="c1"># Initialize the hidden state of your LSTM</span>
    <span class="n">a_prev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># for grading purposes</span>
    <span class="n">last_dino_name</span> <span class="o">=</span> <span class="s2">&quot;abc&quot;</span>

    <span class="c1"># Optimization loop</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">):</span>

        <span class="c1">### START CODE HERE ###</span>

        <span class="c1"># Set the index `idx` (see instructions above)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">j</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>

        <span class="c1"># Set the input X (see instructions above)</span>
        <span class="n">single_example</span> <span class="o">=</span> <span class="n">examples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">single_example_chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">single_example</span><span class="p">)</span>
        <span class="n">single_example_ix</span> <span class="o">=</span> <span class="p">[</span><span class="n">char_to_ix</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">single_example_chars</span><span class="p">]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">+</span><span class="n">single_example_ix</span>

        <span class="c1"># Set the labels Y (see instructions above)</span>
        <span class="n">ix_newline</span> <span class="o">=</span> <span class="n">char_to_ix</span><span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">single_example_ix</span>

        <span class="c1"># Perform one optimization step: Forward-prop -&gt; Backward-prop -&gt; Clip -&gt; Update parameters</span>
        <span class="c1"># Choose a learning rate of 0.01</span>
        <span class="n">curr_loss</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">a_prev</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">a_prev</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>

        <span class="c1">### END CODE HERE ###</span>

        <span class="c1"># debug statements to aid in correctly forming X, Y</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;j = &quot;</span> <span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;idx = &quot;</span><span class="p">,</span> <span class="n">idx</span><span class="p">,)</span> 
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;single_example =&quot;</span><span class="p">,</span> <span class="n">single_example</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;single_example_chars&quot;</span><span class="p">,</span> <span class="n">single_example_chars</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;single_example_ix&quot;</span><span class="p">,</span> <span class="n">single_example_ix</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; X = &quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Y =       &quot;</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># to keep the loss smooth.</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">curr_loss</span><span class="p">)</span>

        <span class="c1"># Every 2000 Iteration, generate &quot;n&quot; characters thanks to sample() to check if the model is learning properly</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Iteration: </span><span class="si">%d</span><span class="s1">, Loss: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># The number of dinosaur names to print</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dino_names</span><span class="p">):</span>

                <span class="c1"># Sample indices and print them</span>
                <span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">char_to_ix</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
                <span class="n">last_dino_name</span> <span class="o">=</span> <span class="n">get_sample</span><span class="p">(</span><span class="n">sampled_indices</span><span class="p">,</span> <span class="n">ix_to_char</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">last_dino_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

                <span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># To get the same result (for grading purposes), increment the seed by one. </span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">last_dino_name</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When you run the following cell, you should observe your model outputting random-looking characters at the first iteration. After a few thousand iterations, your model should learn to generate reasonable-looking names. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">parameters</span><span class="p">,</span> <span class="n">last_name</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">ix_to_char</span><span class="p">,</span> <span class="n">char_to_ix</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">last_name</span> <span class="o">==</span> <span class="s1">&#39;Trodonosaurus</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s2">&quot;Wrong expected output&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[92mAll tests passed!&quot;</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IndexError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-63-758a53694d9c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>parameters<span class="ansi-blue-fg">,</span> last_name <span class="ansi-blue-fg">=</span> model<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;\n&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> ix_to_char<span class="ansi-blue-fg">,</span> char_to_ix<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2001</span><span class="ansi-blue-fg">,</span> verbose <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> 
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-green-fg">assert</span> last_name <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">&#39;Trodonosaurus\n&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;Wrong expected output&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;\033[92mAll tests passed!&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-58-0cb9bc6100c8&gt;</span> in <span class="ansi-cyan-fg">model</span><span class="ansi-blue-fg">(data_x, ix_to_char, char_to_ix, num_iterations, n_a, dino_names, vocab_size, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     61</span>         <span class="ansi-red-fg"># Perform one optimization step: Forward-prop -&gt; Backward-prop -&gt; Clip -&gt; Update parameters</span>
<span class="ansi-green-intense-fg ansi-bold">     62</span>         <span class="ansi-red-fg"># Choose a learning rate of 0.01</span>
<span class="ansi-green-fg">---&gt; 63</span><span class="ansi-red-fg">         </span>curr_loss<span class="ansi-blue-fg">,</span> gradients<span class="ansi-blue-fg">,</span> a_prev <span class="ansi-blue-fg">=</span> optimize<span class="ansi-blue-fg">(</span>X<span class="ansi-blue-fg">,</span> Y<span class="ansi-blue-fg">,</span> a_prev<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> learning_rate <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">0.01</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     64</span> 
<span class="ansi-green-intense-fg ansi-bold">     65</span>         <span class="ansi-red-fg">### END CODE HERE ###</span>

<span class="ansi-green-fg">&lt;ipython-input-49-fca0aba78113&gt;</span> in <span class="ansi-cyan-fg">optimize</span><span class="ansi-blue-fg">(X, Y, a_prev, parameters, learning_rate)</span>
<span class="ansi-green-intense-fg ansi-bold">     32</span> 
<span class="ansi-green-intense-fg ansi-bold">     33</span>     <span class="ansi-red-fg"># Forward propagate through time (≈1 line)</span>
<span class="ansi-green-fg">---&gt; 34</span><span class="ansi-red-fg">     </span>loss<span class="ansi-blue-fg">,</span> cache <span class="ansi-blue-fg">=</span> rnn_forward<span class="ansi-blue-fg">(</span>X<span class="ansi-blue-fg">,</span> Y<span class="ansi-blue-fg">,</span> a_prev<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span> 
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-red-fg"># Backpropagate through time (≈1 line)</span>

<span class="ansi-green-fg">~/work/W1A2/utils.py</span> in <span class="ansi-cyan-fg">rnn_forward</span><span class="ansi-blue-fg">(X, Y, a0, parameters, vocab_size)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> 
<span class="ansi-green-intense-fg ansi-bold">    101</span>         <span class="ansi-red-fg"># Update the loss by substracting the cross-entropy term of this time-step from it.</span>
<span class="ansi-green-fg">--&gt; 102</span><span class="ansi-red-fg">         </span>loss <span class="ansi-blue-fg">-=</span> np<span class="ansi-blue-fg">.</span>log<span class="ansi-blue-fg">(</span>y_hat<span class="ansi-blue-fg">[</span>t<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>Y<span class="ansi-blue-fg">[</span>t<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    103</span> 
<span class="ansi-green-intense-fg ansi-bold">    104</span>     cache <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>y_hat<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">IndexError</span>: list index out of range</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Expected output</strong>
<div class="highlight"><pre><span></span><code>...
Iteration: 22000, Loss: 22.728886

Onustreofkelus
Llecagosaurus
Mystolojmiaterltasaurus
Ola
Yuskeolongus
Eiacosaurus
Trodonosaurus
</code></pre></div></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="conclusion">Conclusion</h3>
<p>You can see that your algorithm has started to generate plausible dinosaur names towards the end of training. At first, it was generating random characters, but towards the end you could begin to see dinosaur names with cool endings. Feel free to run the algorithm even longer and play with hyperparameters to see if you can get even better results! Our implementation generated some really cool names like <code>maconucon</code>, <code>marloralus</code> and <code>macingsersaurus</code>. Your model hopefully also learned that dinosaur names tend to end in <code>saurus</code>, <code>don</code>, <code>aura</code>, <code>tor</code>, etc.</p>
<p>If your model generates some non-cool names, don't blame the model entirely -- not all actual dinosaur names sound cool. (For example, <code>dromaeosauroides</code> is an actual dinosaur name and is in the training set.) But this model should give you a set of candidates from which you can pick the coolest! </p>
<p>This assignment used a relatively small dataset, so that you're able to train an RNN quickly on a CPU. Training a model of the English language requires a much bigger dataset, and usually much more computation, and could run for many hours on GPUs. We ran our dinosaur name for quite some time, and so far our favorite name is the great, the fierce, the undefeated: <strong>Mangosaurus</strong>!</p>
<p><img src="images/mangosaurus.jpeg" style="width:250;height:300px;"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="congratulations">Congratulations!</h3>
<p>You've finished the graded portion of this notebook and created a working language model! Awesome job. </p>
<p>By now, you've: </p>
<ul>
<li>Stored text data for processing using an RNN </li>
<li>Built a character-level text generation model</li>
<li>Explored the vanishing/exploding gradient problem in RNNs</li>
<li>Applied gradient clipping to avoid exploding gradients</li>
</ul>
<p>You've also hopefully generated some dinosaur names that are cool enough to please you and also avoid the wrath of the dinosaurs. If you had fun with the assignment, be sure not to miss the ungraded portion, where you'll be able to generate poetry like the Bard Himself. Good luck and have fun!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='4'></a></p>
<h2 id="4-writing-like-shakespeare-optionalungraded">4 - Writing like Shakespeare (OPTIONAL/UNGRADED)</h2>
<p>The rest of this notebook is optional and is not graded, but it's quite fun and informative, so you're highly encouraged to try it out! </p>
<p>A similar task to character-level text generation (but more complicated) is generating Shakespearean poems. Instead of learning from a dataset of dinosaur names, you can use a collection of Shakespearean poems. Using LSTM cells, you can learn longer-term dependencies that span many characters in the text--e.g., where a character appearing somewhere a sequence can influence what should be a different character, much later in the sequence. These long-term dependencies were less important with dinosaur names, since the names were quite short. </p>
<p><img src="images/shakespeare.jpg" style="width:500;height:400px;">
<caption><center><font color='purple'><b>Let's become poets!</b></center></caption></p>
<p>Below, you can implement a Shakespeare poem generator with Keras. Run the following cell to load the required packages and models. This may take a few minutes. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">LambdaCallback</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">load_model</span><span class="p">,</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Masking</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">get_file</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.sequence</span> <span class="kn">import</span> <span class="n">pad_sequences</span>
<span class="kn">from</span> <span class="nn">shakespeare_utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">io</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Loading text data...
Creating training set...
number of training examples: 31412
Vectorizing training set...
Loading model...
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To save you some time, a model has already been trained for ~1000 epochs on a collection of Shakespearean poems called "<i><a href="shakespeare.txt">The Sonnets</a></i>."</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's train the model for one more epoch. When it finishes training for an epoch (this will also take a few minutes), you can run <code>generate_output</code>, which will prompt you for an input (<code>&lt;</code>40 characters). The poem will start with your sentence, and your RNN Shakespeare will complete the rest of the poem for you! For example, try, "Forsooth this maketh no sense" (without the quotation marks!). Depending on whether you include the space at the end, your results might also differ, so try it both ways, and try other inputs as well. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">print_callback</span> <span class="o">=</span> <span class="n">LambdaCallback</span><span class="p">(</span><span class="n">on_epoch_end</span><span class="o">=</span><span class="n">on_epoch_end</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">print_callback</span><span class="p">])</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>246/246 [==============================] - 108s 439ms/step - loss: 2.5637
</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>&lt;tensorflow.python.keras.callbacks.History at 0x7f1cd9f91b10&gt;</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># Run this cell to try with different inputs without having to re-train the model </span>
<span class="n">generate_output</span><span class="p">()</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Write the beginning of your poem, the Shakespeare machine will complete it. Your input is: Forsooth this maketh no sense  


Here is your poem: 

Forsooth this maketh no sense  his stemelts
fens thot age&#39;s mime, that bes of not the prened my wasse,
and frorsh trusiled and my fior worss wide cucflistan the mirot sid.
i morn wased to bust to day li hadpefe
in thand this shy have athight me and hang,
that every wotenn&#39;s this with noth, and worss dided to do dess o&#39;h.
her beeun the canslies hang in thy bery.


hoand been what guaess aper yet for heaver.
whon thuy be ounled </code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="congratulations-on-finishing-this-notebook">Congratulations on finishing this notebook!</h3>
<p>The RNN Shakespeare model is very similar to the one you built for dinosaur names. The only major differences are:
- LSTMs instead of the basic RNN to capture longer-range dependencies
- The model is a deeper, stacked LSTM model (2 layer)
- Using Keras instead of Python to simplify the code </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name='5'></a></p>
<h2 id="5-references">5 - References</h2>
<ul>
<li>This exercise took inspiration from Andrej Karpathy's implementation: https://gist.github.com/karpathy/d4dee566867f8291f086. To learn more about text generation, also check out Karpathy's <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">blog post</a>.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/hari31416" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/hari31416" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/hari31416" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.kaggle.com/hari31416" target="_blank" rel="noopener" title="www.kaggle.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/hari31416" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.top", "toc.integrate"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>